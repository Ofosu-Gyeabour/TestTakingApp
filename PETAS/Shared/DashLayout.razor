@inherits LayoutComponentBase

@inject ITrainingService oTrainingService

<html lang="en">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="Content-Language" content="en">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <title>DashBoard</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, shrink-to-fit=no" />
    <meta name="description" content="This is an example dashboard created using build-in elements and components.">
    <meta name="msapplication-tap-highlight" content="no">

    <link href="css/main.css" rel="stylesheet">
    <body>
        <div class="app-container app-theme-white body-tabs-shadow fixed-sidebar fixed-header">
            <DashHeader />    
            
                <div class="app-main">
          
                        </div> 

				        <div class="app-main__outer">
                            <div class="app-main__inner">
                                @if(totalTrainings != null)
                                {
                                    <div class="row">
                                            <div class="col-md-6 col-xl-4">
                                                <div class="card mb-3 widget-content bg-midnight-bloom">
                                                    <div class="widget-content-wrapper text-white">
                                                        <div class="widget-content-left">
                                                            <div class="widget-heading">Total Trainings</div>
                                                            <div class="widget-subheading">Trainings taken thus far</div>
                                                        </div>
                                                        <div class="widget-content-right">
                                                            <div class="widget-numbers text-white"><span>@totalTrainings.Count().ToString()</span></div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-6 col-xl-4">
                                                <div class="card mb-3 widget-content bg-arielle-smile">
                                                    <div class="widget-content-wrapper text-white">
                                                        <div class="widget-content-left">
                                                            <div class="widget-heading">Pending Trainings</div>
                                                            <div class="widget-subheading">Trainings to take</div>
                                                        </div>
                                                        <div class="widget-content-right">
                                                            <div class="widget-numbers text-white"><span>@pendingTrainings.ToString()</span></div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-6 col-xl-4">
                                                <div class="card mb-3 widget-content bg-grow-early">
                                                    <div class="widget-content-wrapper text-white">
                                                        <div class="widget-content-left">
                                                            <div class="widget-heading">Past Trainings</div>
                                                            <div class="widget-subheading">Historical</div>
                                                        </div>
                                                        <div class="widget-content-right">
                                                            <div class="widget-numbers text-white"><span>@(finishedTrainings + cancelledTrainings)</span></div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="d-xl-none d-lg-block col-md-6 col-xl-4">
                                                <div class="card mb-3 widget-content bg-premium-dark">
                                                    <div class="widget-content-wrapper text-white">
                                                        <div class="widget-content-left">
                                                            <div class="widget-heading">Products Sold</div>
                                                            <div class="widget-subheading">Revenue streams</div>
                                                        </div>
                                                        <div class="widget-content-right">
                                                            <div class="widget-numbers text-warning"><span>$14M</span></div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                    </div>
                                }
                 
                                <div class="row">
                                    <div class="col-md-12 col-lg-6">
                                        <div class="mb-3 card">
                                            <div class="card-body">
                                                <div class="tab-content">
                                                    <div class="tab-pane fade show active" id="tabs-eg-77">
                                                        <h6 class="text-muted text-uppercase font-size-md opacity-5 font-weight-normal">Past Assessments</h6>
                                                        <div class="scroll-area-sm">
                                                            <div class="scrollbar-container">
                                                                <ul class="rm-list-borders rm-list-borders-scroll list-group list-group-flush">
                                                                    <li class="list-group-item">
                                                                        <div class="widget-content p-0">
                                                                            <div class="widget-content-wrapper">
                                                                                <div class="widget-content-left mr-3">
                                                                                    <img width="42" class="rounded-circle" src="assets/images/avatars/9.jpg" alt="">
                                                                                </div>
                                                                                <div class="widget-content-left">
                                                                                    <div class="widget-heading">Ella-Rose Henry</div>
                                                                                    <div class="widget-subheading">Web Developer</div>
                                                                                </div>
                                                                                <div class="widget-content-right">
                                                                                    <div class="font-size-xlg text-muted">
                                                                                        <small class="opacity-5 pr-1">$</small>
                                                                                        <span>129</span>
                                                                                        <small class="text-danger pl-2">
                                                                                            <i class="fa fa-angle-down"></i>
                                                                                        </small>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </li>
                                                                </ul>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-12 col-lg-6">
                                        <div class="mb-3 card">
                                            <div class="card-header-tab card-header">
                                                <div class="btn-actions-pane-right">
                                                    <div class="nav">
                                                        <a href="javascript:void(0);" class="border-0 btn-pill btn-wide btn-transition active btn btn-outline-alternate">Top 20</a>
                                                        <a href="javascript:void(0);" class="ml-1 btn-pill btn-wide border-0 btn-transition  btn btn-outline-alternate second-tab-toggle-alt">All</a>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="tab-content">
                                                <div class="tab-pane fade active show" id="tab-eg-55">
                                                    
                                                    <div class="pt-2 card-body">
                                                        <div class="row">
                                                            <div class="col-md-6">
                                                                <div class="widget-content">
                                                                    <div class="widget-content-outer">
                                                                        <div class="widget-content-wrapper">
                                                                            <div class="widget-content-left">
                                                                                <div class="widget-numbers fsize-3 text-muted">63%</div>
                                                                            </div>
                                                                            <div class="widget-content-right">
                                                                                <div class="text-muted opacity-6">Generated Leads</div>
                                                                            </div>
                                                                        </div>
                                                                        <div class="widget-progress-wrapper mt-1">
                                                                            <div class="progress-bar-sm progress-bar-animated-alt progress">
                                                                                <div class="progress-bar bg-danger" role="progressbar" aria-valuenow="63" aria-valuemin="0" aria-valuemax="100" style="width: 63%;"></div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="col-md-6">
                                                                <div class="widget-content">
                                                                    <div class="widget-content-outer">
                                                                        <div class="widget-content-wrapper">
                                                                            <div class="widget-content-left">
                                                                                <div class="widget-numbers fsize-3 text-muted">32%</div>
                                                                            </div>
                                                                            <div class="widget-content-right">
                                                                                <div class="text-muted opacity-6">Submitted Tickers</div>
                                                                            </div>
                                                                        </div>
                                                                        <div class="widget-progress-wrapper mt-1">
                                                                            <div class="progress-bar-sm progress-bar-animated-alt progress">
                                                                                <div class="progress-bar bg-success" role="progressbar" aria-valuenow="32" aria-valuemin="0" aria-valuemax="100" style="width: 32%;"></div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="col-md-6">
                                                                <div class="widget-content">
                                                                    <div class="widget-content-outer">
                                                                        <div class="widget-content-wrapper">
                                                                            <div class="widget-content-left">
                                                                                <div class="widget-numbers fsize-3 text-muted">71%</div>
                                                                            </div>
                                                                            <div class="widget-content-right">
                                                                                <div class="text-muted opacity-6">Server Allocation</div>
                                                                            </div>
                                                                        </div>
                                                                        <div class="widget-progress-wrapper mt-1">
                                                                            <div class="progress-bar-sm progress-bar-animated-alt progress">
                                                                                <div class="progress-bar bg-primary" role="progressbar" aria-valuenow="71" aria-valuemin="0" aria-valuemax="100" style="width: 71%;"></div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="col-md-6">
                                                                <div class="widget-content">
                                                                    <div class="widget-content-outer">
                                                                        <div class="widget-content-wrapper">
                                                                            <div class="widget-content-left">
                                                                                <div class="widget-numbers fsize-3 text-muted">41%</div>
                                                                            </div>
                                                                            <div class="widget-content-right">
                                                                                <div class="text-muted opacity-6">Generated Leads</div>
                                                                            </div>
                                                                        </div>
                                                                        <div class="widget-progress-wrapper mt-1">
                                                                            <div class="progress-bar-sm progress-bar-animated-alt progress">
                                                                                <div class="progress-bar bg-warning" role="progressbar" aria-valuenow="41" aria-valuemin="0" aria-valuemax="100" style="width: 41%;"></div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                @*<div class="row">
                                    <div class="col-md-6 col-xl-4">
                                        <div class="card mb-3 widget-content">
                                            <div class="widget-content-outer">
                                                <div class="widget-content-wrapper">
                                                    <div class="widget-content-left">
                                                        <div class="widget-heading">Total Orders</div>
                                                        <div class="widget-subheading">Last year expenses</div>
                                                    </div>
                                                    <div class="widget-content-right">
                                                        <div class="widget-numbers text-success">1896</div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6 col-xl-4">
                                        <div class="card mb-3 widget-content">
                                            <div class="widget-content-outer">
                                                <div class="widget-content-wrapper">
                                                    <div class="widget-content-left">
                                                        <div class="widget-heading">Products Sold</div>
                                                        <div class="widget-subheading">Revenue streams</div>
                                                    </div>
                                                    <div class="widget-content-right">
                                                        <div class="widget-numbers text-warning">$3M</div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6 col-xl-4">
                                        <div class="card mb-3 widget-content">
                                            <div class="widget-content-outer">
                                                <div class="widget-content-wrapper">
                                                    <div class="widget-content-left">
                                                        <div class="widget-heading">Followers</div>
                                                        <div class="widget-subheading">People Interested</div>
                                                    </div>
                                                    <div class="widget-content-right">
                                                        <div class="widget-numbers text-danger">45,9%</div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="d-xl-none d-lg-block col-md-6 col-xl-4">
                                        <div class="card mb-3 widget-content">
                                            <div class="widget-content-outer">
                                                <div class="widget-content-wrapper">
                                                    <div class="widget-content-left">
                                                        <div class="widget-heading">Income</div>
                                                        <div class="widget-subheading">Expected totals</div>
                                                    </div>
                                                    <div class="widget-content-right">
                                                        <div class="widget-numbers text-focus">$147</div>
                                                    </div>
                                                </div>
                                                <div class="widget-progress-wrapper">
                                                    <div class="progress-bar-sm progress-bar-animated-alt progress">
                                                        <div class="progress-bar bg-info" role="progressbar" aria-valuenow="54" aria-valuemin="0" aria-valuemax="100" style="width: 54%;"></div>
                                                    </div>
                                                    <div class="progress-sub-label">
                                                        <div class="sub-label-left">Expenses</div>
                                                        <div class="sub-label-right">100%</div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>*@
                                
                                <div class="row">
                                    <div class="col-md-12">
                                        <div class="main-card mb-3 card">
                                            <DashUserTrainings />
                                        </div>
                                    </div>
                                </div>
                                
                                @*<div class="row">
                                    <DashFooter />
                                </div>*@
                            </div>
                            <div class="app-wrapper-footer">
                                <div class="app-footer">
                                    <div class="app-footer__inner">
                                
                                    </div>
                                </div>
                            </div>    
                            </div>
                
        </div>
    
    </body>
</html>
@code{
    private List<Training> totalTrainings;
    private int pendingTrainings;
    private int finishedTrainings;
    private int cancelledTrainings;

    protected override async Task OnInitializedAsync()
    {
        await base.OnInitializedAsync();
        await GetTrainingsDataPoints();
    }

    private async Task GetTrainingsDataPoints()
    {
        var tList = await oTrainingService.GetTrainingsAsync();
        if (tList != null)
        {
            foreach(var t in tList)
            {
                if (t.TrainingStatusId == 1)
                {
                    pendingTrainings += 1;
                }
                else if (t.TrainingStatusId == 2)
                {
                    finishedTrainings += 1;
                }
                else
                {
                    cancelledTrainings += 1;
                }
            }
        }

        totalTrainings = tList;
        StateHasChanged();
    }

}